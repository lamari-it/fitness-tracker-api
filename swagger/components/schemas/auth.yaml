# Auth Schemas

RegisterRequest:
  type: object
  required:
    - email
    - password
    - password_confirm
    - first_name
    - last_name
  properties:
    email:
      type: string
      format: email
      maxLength: 255
      example: "user@example.com"
    password:
      type: string
      format: password
      minLength: 8
      maxLength: 128
      example: "SecurePass123!"
    password_confirm:
      type: string
      format: password
      example: "SecurePass123!"
    first_name:
      type: string
      minLength: 1
      maxLength: 100
      example: "John"
    last_name:
      type: string
      minLength: 1
      maxLength: 100
      example: "Doe"
    trainer_profile:
      $ref: '#/TrainerProfileData'

TrainerProfileData:
  type: object
  description: Optional trainer profile to create during registration
  properties:
    bio:
      type: string
      maxLength: 1000
      example: "Certified personal trainer with 5 years experience"
    specialty_ids:
      type: array
      maxItems: 20
      items:
        type: string
        format: uuid
    hourly_rate:
      type: number
      format: float
      minimum: 0
      maximum: 9999.99
      example: 75.00
    location:
      type: string
      maxLength: 500
      example: "New York, NY"
    visibility:
      type: string
      enum: [public, link_only, private]
      default: private

LoginRequest:
  type: object
  required:
    - email
    - password
  properties:
    email:
      type: string
      format: email
      maxLength: 255
      example: "user@example.com"
    password:
      type: string
      format: password
      minLength: 1
      maxLength: 128
      example: "SecurePass123!"
    device_info:
      type: string
      maxLength: 255
      description: Optional device identifier for session management
      example: "iPhone 15 Pro"

RefreshTokenRequest:
  type: object
  required:
    - refresh_token
  properties:
    refresh_token:
      type: string
      description: The refresh token to exchange for a new token pair
      example: "dGVzdF9yZWZyZXNoX3Rva2VuXzEyMzQ1Njc4OTA..."
    device_info:
      type: string
      maxLength: 255
      description: Optional device identifier for session management
      example: "iPhone 15 Pro"

AuthResponse:
  type: object
  properties:
    success:
      type: boolean
      example: true
    message:
      type: string
      example: "Registration successful"
    data:
      type: object
      properties:
        user:
          $ref: './user.yaml#/UserResponse'
        access_token:
          type: string
          description: JWT access token for API authentication (15 minute expiry)
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        refresh_token:
          type: string
          description: Refresh token to obtain new access tokens (7 day expiry)
          example: "dGVzdF9yZWZyZXNoX3Rva2VuXzEyMzQ1Njc4OTA..."
        expires_in:
          type: integer
          description: Access token expiry time in seconds
          example: 3600
        token_type:
          type: string
          description: Token type for Authorization header
          example: "Bearer"
        token:
          type: string
          description: "Deprecated: Use access_token instead. Kept for backward compatibility."
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          deprecated: true
        trainer_profile:
          $ref: './trainer.yaml#/TrainerProfileResponse'

SessionResponse:
  type: object
  properties:
    id:
      type: string
      format: uuid
      description: Session ID
    device_info:
      type: string
      description: Device identifier provided during login
      example: "iPhone 15 Pro"
    ip_address:
      type: string
      description: IP address used during login
      example: "192.168.1.1"
    user_agent:
      type: string
      description: User agent string from the login request
      example: "Mozilla/5.0..."
    last_used_at:
      type: string
      format: date-time
      description: When the session was last used for token refresh
    created_at:
      type: string
      format: date-time
      description: When the session was created
    is_current:
      type: boolean
      description: Whether this is the current session (requires X-Refresh-Token header)

AppleAuthRequest:
  type: object
  required:
    - id_token
  properties:
    id_token:
      type: string
      description: Apple ID token
    authorization_code:
      type: string
      description: Apple authorization code
