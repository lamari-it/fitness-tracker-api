# Search Endpoints

/search/users:
  get:
    tags:
      - Search
    summary: Search users by location
    description: |
      Search for users by location using one of three strategies (in priority order):
      1. **Radius search**: Provide latitude, longitude, and radius_km to find users within a geographic radius
      2. **Structured text search**: Provide country_code, region, city, district, or postal_code for exact field matching
      3. **Free-text fallback**: Provide q parameter to search across all location text fields
    operationId: searchUsers
    security:
      - bearerAuth: []
    parameters:
      - name: latitude
        in: query
        description: Latitude coordinate for radius search (requires longitude and radius_km)
        schema:
          type: number
          format: float
          minimum: -90
          maximum: 90
          example: 40.7128
      - name: longitude
        in: query
        description: Longitude coordinate for radius search (requires latitude and radius_km)
        schema:
          type: number
          format: float
          minimum: -180
          maximum: 180
          example: -74.0060
      - name: radius_km
        in: query
        description: Search radius in kilometers (requires latitude and longitude)
        schema:
          type: number
          format: float
          minimum: 0.1
          maximum: 500
          example: 25
      - name: country_code
        in: query
        description: ISO 3166-1 alpha-2 country code for structured search
        schema:
          type: string
          minLength: 2
          maxLength: 2
          example: US
      - name: region
        in: query
        description: State, province, or region for structured search
        schema:
          type: string
          maxLength: 100
          example: NY
      - name: city
        in: query
        description: City name for structured search
        schema:
          type: string
          maxLength: 100
          example: New York
      - name: district
        in: query
        description: District, neighborhood, or borough for structured search
        schema:
          type: string
          maxLength: 100
          example: Manhattan
      - name: postal_code
        in: query
        description: Postal or ZIP code for structured search
        schema:
          type: string
          maxLength: 20
          example: "10001"
      - name: q
        in: query
        description: Free-text search query (searches across all location fields)
        schema:
          type: string
          maxLength: 200
          example: New York
      - name: page
        in: query
        description: Page number for pagination
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        description: Number of results per page
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    responses:
      '200':
        description: Successfully retrieved users
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Users retrieved successfully"
                data:
                  type: array
                  items:
                    $ref: '../components/schemas/user.yaml#/UserResponse'
                meta:
                  $ref: '../components/schemas/common.yaml#/PaginationMeta'
      '400':
        description: Invalid query parameters
        content:
          application/json:
            schema:
              $ref: '../components/schemas/common.yaml#/ErrorResponse'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../components/schemas/common.yaml#/ErrorResponse'

/search/trainers:
  get:
    tags:
      - Search
    summary: Search trainers by location
    description: |
      Search for trainers by location using one of three strategies (in priority order):
      1. **Radius search**: Provide latitude, longitude, and radius_km to find trainers within a geographic radius
      2. **Structured text search**: Provide country_code, region, city, district, or postal_code for exact field matching
      3. **Free-text fallback**: Provide q parameter to search across all location text fields

      Additional filters available for specialty IDs and hourly rate range.
    operationId: searchTrainers
    security:
      - bearerAuth: []
    parameters:
      - name: latitude
        in: query
        description: Latitude coordinate for radius search (requires longitude and radius_km)
        schema:
          type: number
          format: float
          minimum: -90
          maximum: 90
          example: 40.7128
      - name: longitude
        in: query
        description: Longitude coordinate for radius search (requires latitude and longitude)
        schema:
          type: number
          format: float
          minimum: -180
          maximum: 180
          example: -74.0060
      - name: radius_km
        in: query
        description: Search radius in kilometers (requires latitude and longitude)
        schema:
          type: number
          format: float
          minimum: 0.1
          maximum: 500
          example: 25
      - name: country_code
        in: query
        description: ISO 3166-1 alpha-2 country code for structured search
        schema:
          type: string
          minLength: 2
          maxLength: 2
          example: US
      - name: region
        in: query
        description: State, province, or region for structured search
        schema:
          type: string
          maxLength: 100
          example: NY
      - name: city
        in: query
        description: City name for structured search
        schema:
          type: string
          maxLength: 100
          example: New York
      - name: district
        in: query
        description: District, neighborhood, or borough for structured search
        schema:
          type: string
          maxLength: 100
          example: Manhattan
      - name: postal_code
        in: query
        description: Postal or ZIP code for structured search
        schema:
          type: string
          maxLength: 20
          example: "10001"
      - name: q
        in: query
        description: Free-text search query (searches across all location fields)
        schema:
          type: string
          maxLength: 200
          example: New York
      - name: specialty_ids
        in: query
        description: Filter by trainer specialty IDs (comma-separated UUIDs)
        schema:
          type: array
          items:
            type: string
            format: uuid
        style: form
        explode: false
      - name: min_hourly_rate
        in: query
        description: Minimum hourly rate filter
        schema:
          type: number
          format: float
          minimum: 0
          example: 50
      - name: max_hourly_rate
        in: query
        description: Maximum hourly rate filter
        schema:
          type: number
          format: float
          minimum: 0
          example: 150
      - name: page
        in: query
        description: Page number for pagination
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        description: Number of results per page
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    responses:
      '200':
        description: Successfully retrieved trainers
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Trainers retrieved successfully"
                data:
                  type: array
                  items:
                    $ref: '../components/schemas/trainer.yaml#/TrainerPublicResponse'
                meta:
                  $ref: '../components/schemas/common.yaml#/PaginationMeta'
      '400':
        description: Invalid query parameters
        content:
          application/json:
            schema:
              $ref: '../components/schemas/common.yaml#/ErrorResponse'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../components/schemas/common.yaml#/ErrorResponse'
